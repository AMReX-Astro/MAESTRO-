

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Notes on Thermodynamics &mdash; MAESTROeX 19.03
 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"rhozero": "{\\rho_0}", "pizero": "{\\pi_0}", "pizeroone": "{\\pi_0^{(1)}}", "pizerotwo": "{\\pi_0^{(2)}}", "gammabar": "{\\overline{\\Gamma}_1}", "ptl": "{\\partial}", "eb": "{{\\bf e}}", "fb": "{{\\bf f}}", "ib": "{{\\bf i}}", "Ub": "{{\\bf U}}", "Vb": "{{\\bf V}}", "xb": "{{\\bf x}}", "ut": "{{\\tilde{u}}}", "vt": "{{\\tilde{v}}}", "wt": "{{\\tilde{w}}}", "Ubt": "{\\widetilde{\\Ub}}", "edge": "{{\\rm EDGE}}", "mac": "{{\\rm MAC}}", "trans": "{{\\rm TRANS}}", "nablab": "{\\mathbf{\\nabla}}", "cdotb": "{\\mathbf{\\cdot}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\frac{1}{2}}", "nph": "{{n + \\myhalf}}", "nmh": "{{n - \\myhalf}}", "Hext": "{{H_{\\rm ext}}}", "Hnuc": "{{H_{\\rm nuc}}}", "kth": "{k_{\\rm th}}", "pred": "{{\\rm pred}}", "Sbar": "{\\overline{S}}", "inp": "{\\mathrm{in}}", "initp": "{\\mathrm{init}}", "outp": "{\\mathrm{out}}", "uadv": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvone": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV},\\star}}", "uadvonedag": "{\\Ubt^{\\mathrm{ADV},\\dagger,\\star}}", "uadvtwo": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvtwodag": "{\\Ubt^{\\mathrm{ADV},\\dagger}}", "uadvsdcstar": "{\\mathbf{U}^{\\mathrm{ADV},\\star}}", "uadvsdcpred": "{\\mathbf{U}^{\\mathrm{ADV},\\mathrm{pred}}}", "uadvsdc": "{\\mathbf{U}^{\\mathrm{ADV}}}", "dt": "{\\Delta t}", "dr": "{\\Delta r}", "etarho": "{\\eta_{\\rho}}", "etarhoec": "{\\etarho^{\\rm ec}}", "etarhocc": "{\\etarho^{\\rm cc}}", "etarhoflux": "{\\etarho^{\\rm flux}}", "divetarho": "{\\nabla\\cdot(\\etarho\\eb_r)}", "ow": "{\\overline{w}_0}", "dw": "{\\delta w_0}", "thalf": "{\\frac{3}{2}}", "rhop": "{{\\rho^{\\prime}}}", "omegadot": "{\\dot{\\omega}}", "er": "{\\mathbf{e}_r}", "ex": "{\\mathbf{e}_x}", "ey": "{\\mathbf{e}_y}", "ez": "{\\mathbf{e}_z}", "Omegab": "{{\\bf \\Omega}}", "rb": "{{\\bf r}}", "boxtype": "{{\\tt box\\/}}", "fab": "{{\\tt fab\\/}}", "multifab": "{{\\tt multifab\\/}}", "boxarray": "{{\\tt boxarray\\/}}", "mlboxarray": "{{\\tt ml\\_boxarray\\/}}", "layout": "{{\\tt layout\\/}}", "mllayout": "{{\\tt ml\\_layout\\/}}", "bctower": "{{\\tt bc\\_tower\\/}}", "bclevel": "{{\\tt bc\\_level\\/}}", "mgtower": "{{\\tt mg\\_tower\\/}}", "bndryreg": "{{\\tt bndry\\_reg\\/}}", "runparam": ["{\\index{Runtime parameters!{\\tt #1}}{\\tt #1}}", 1], "runparamidx": ["{\\index{Runtime parameters!{\\tt #1}}}", 1], "code": ["{\\index{Code reference!{\\tt #1}}{\\tt #1}}", 1], "codeidx": ["{\\index{Code reference!{\\tt #1}}}", 1], "otherindex": ["{\\index{#1!#2}}", 2], "fdamp": "{{f_\\mathrm{damp}}}"}}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notes on \(\beta_0\)" href="beta0.html" />
    <link rel="prev" title="Modifications for a \(1/r^2\) Plane-Parallel Basestate" href="planar_invsq_basestate.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MAESTROeX
          

          
          </a>

          
            
            
              <div class="version">
                19.03

              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">MAESTROeX basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to MAESTROeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="flowchart.html">MAESTROeX Flowchart</a></li>
</ul>
<p class="caption"><span class="caption-text">Using MAESTROeX</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Problem Setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="unit_tests.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="common_parameters.html">Common Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">MAESTROeX Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="param_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial_models.html">Initial Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="makefiles.html">MAESTROeX Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="managingjobs.html">Managing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MAESTROeX technical details</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="lo_density.html">Low Density Cutoffs</a></li>
<li class="toctree-l1"><a class="reference internal" href="volume_discrepancy.html">Volume Discrepancy Factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="eos_notes.html">Equation of State Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Reaction Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html">The Mixing Term, <span class="math notranslate nohighlight">\(\etarho\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#eta-flow-chart"><span class="math notranslate nohighlight">\(\eta\)</span> Flow Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#computing-etarhoec-and-etarhocc">Computing <span class="math notranslate nohighlight">\(\etarhoec\)</span> and <span class="math notranslate nohighlight">\(\etarhocc\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#using-etarhoec">Using <span class="math notranslate nohighlight">\(\etarhoec\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#using-etarhocc">Using <span class="math notranslate nohighlight">\(\etarhocc\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="pert.html">Interface State Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="Godunov.html">Godunov Interface States</a></li>
<li class="toctree-l1"><a class="reference internal" href="mg.html">Multigrid</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation in MAESTROeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="spherical_basestate.html">Modifications for a Spherical Self-Gravitating Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="planar_invsq_basestate.html">Modifications for a <span class="math notranslate nohighlight">\(1/r^2\)</span> Plane-Parallel Basestate</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Notes on Thermodynamics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#derivatives-with-respect-to-composition">Derivatives With Respect to Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#convective-stability-criterion">Convective stability criterion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adiabatic-excess">Adiabatic Excess</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beta0.html">Notes on <span class="math notranslate nohighlight">\(\beta_0\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="enthalpy.html">Notes on Enthalpy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MAESTROeX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Notes on Thermodynamics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/thermo_notes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="notes-on-thermodynamics">
<h1>Notes on Thermodynamics<a class="headerlink" href="#notes-on-thermodynamics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="derivatives-with-respect-to-composition">
<h2>Derivatives With Respect to Composition<a class="headerlink" href="#derivatives-with-respect-to-composition" title="Permalink to this headline">¶</a></h2>
<p>In the following we assume that the molar mass of species <span class="math notranslate nohighlight">\(i\)</span> is given by its
atomic mass number, <span class="math notranslate nohighlight">\(A_i = N_i + Z_i\)</span> where <span class="math notranslate nohighlight">\(N_i\)</span> is the number of neutrons
and <span class="math notranslate nohighlight">\(Z_i\)</span> is the number of protons in the isotope. This
is a slight approximation that ignores the mass difference between protons
and neutrons as well as some minor binding energy terms.</p>
<p>The number density [cm:math:<cite>^-{3}</cite>] of isotope <span class="math notranslate nohighlight">\(i\)</span> is can be formed from the mass
density and the molar mass of that isotope as follows:</p>
<div class="math notranslate nohighlight">
\[\label{eq:number density}
  n_i = \frac{\rho_i N_\text{A}}{A_i},\]</div>
<p>where <span class="math notranslate nohighlight">\(N_\text{A}\)</span> is Avogadro’s number [# / mole]. The molar abundance,
<span class="math notranslate nohighlight">\(Y_i\)</span>, is a measure of the number of moles of species <span class="math notranslate nohighlight">\(i\)</span> per gram in the
system:</p>
<div class="math notranslate nohighlight">
\[\label{eq:molar abundance}
  Y_i = \frac{n_i}{\rho N_\text{A}} = \frac{\rho_i}{\rho}\frac{1}{A_i}
  \equiv \frac{X_i}{A_i}\]</div>
<p>where we have defined the mass fraction, <span class="math notranslate nohighlight">\(X_i = \frac{\rho_i}{\rho}\)</span>. Note</p>
<div class="math notranslate nohighlight">
\[\label{eq:mass fraction sums to 1}
  \sum_i X_i = 1.\]</div>
<p>We write the average molar mass and average proton number as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\label{eq:abar}
  \bar{A} &amp;= \frac{\sum_i A_i n_i}{\sum_i n_i} = \left(\sum_i X_i\right)
  \left(\sum_i \frac{X_i}{A_i}\right)^{-1}\\
  \label{eq:zbar}
  \bar{Z} &amp;= \frac{\sum_i Z_i n_i}{\sum_i n_i} = \left(\sum_i Z_i
  \frac{X_i}{A_i}\right)\left(\sum_i \frac{X_i}{A_i}\right)^{-1}.\end{aligned}\end{split}\]</div>
<p>Our algorithm requires terms involving the derivative thermodynamic variables
(<span class="math notranslate nohighlight">\(p\)</span> or <span class="math notranslate nohighlight">\(e\)</span>, e.g.) with respect to composition. Our EOS does not return such
derivatives but instead returns derivatives of these variables with respect
to <span class="math notranslate nohighlight">\(\bar{A}\)</span> and <span class="math notranslate nohighlight">\(\bar{Z}\)</span>. Using the chain rule, we have</p>
<div class="math notranslate nohighlight">
\[\label{eq:p_xk}
  \frac{\ptl p}{\ptl X_k} = p_{X_k} =
  \frac{\ptl p}{\ptl \bar{A}}\frac{\ptl \bar{A}}{\ptl X_k} +
  \frac{\ptl p}{\ptl \bar{Z}}\frac{\ptl \bar{Z}}{\ptl X_k}.\]</div>
<p>From <a class="reference external" href="#eq:abar">[eq:abar]</a> and <a class="reference external" href="#eq:zbar">[eq:zbar]</a> we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\label{eq:abar_X_k}
  \frac{\ptl \bar{A}}{\ptl X_k} &amp;= \left(\sum_i \frac{X_i}{A_i}\right)^{-1}
  - \frac{\bar{A}^2}{A_k} = -\frac{\bar{A}}{A_k}\left(\bar{A} - A_k\right)\\
  \label{eq:zbar_X_k}
  \frac{\ptl \bar{Z}}{\ptl X_k} &amp;=
  \left(\frac{Z_k}{A_k}\right)\left(\sum_i \frac{X_i}{A_i}\right)^{-1}
  - \frac{\bar{Z}}{A_k}\left(\sum_i \frac{X_i}{A_i}\right)^{-1} =
  -\frac{\bar{A}}{A_k}\left(\bar{Z} - Z_k\right),\end{aligned}\end{split}\]</div>
<p>where after differentiation we have used <a class="reference external" href="#eq:massfractionsumsto1">[eq:mass fraction sums to 1]</a>
to write</p>
<div class="math notranslate nohighlight">
\[\left(\sum_i \frac{X_i}{A_i}\right)^{-1} = \bar{A}.\]</div>
<p>We therefore have</p>
<div class="math notranslate nohighlight">
\[\label{eq:p_Xk_full}
  p_{X_k} = -\frac{\bar{A}}{A_k}\left(\bar{A} - A_k\right)
  \frac{\ptl p}{\ptl\bar{A}} - \frac{\bar{A}}{A_k}\left(\bar{Z} - Z_k\right)
  \frac{\ptl p}{\ptl\bar{Z}}.\]</div>
<p>Before it was brought to our attention by Frank Timmes, we were missing the
second term in <a class="reference external" href="#eq:abar_X_k">[eq:abar_X_k]</a>. The only place where such terms
appear in our algorithm is in a sum over all species, such as:</p>
<div class="math notranslate nohighlight">
\[\label{eq:sum over species}
  \sum_i p_{X_i}\dot{\omega}_i =
  -\bar{A}^2\frac{\ptl p}{\ptl\bar{A}}\sum_i \frac{\dot{\omega}_i}{A_i}
  +\bar{A}\frac{\ptl p}{\ptl\bar{A}}\sum_i \dot{\omega}_i
  -\bar{A}\bar{Z}\frac{\ptl p}{\ptl\bar{Z}}\sum_i \frac{\dot{\omega}_i}{A_i}
  +\bar{A}\frac{\ptl p}{\ptl \bar{Z}}\sum_i\frac{Z_i}{A_i}\dot{\omega}_i.\]</div>
<p>The second term in <a class="reference external" href="#eq:sumoverspecies">[eq:sum over species]</a> is identically zero because</p>
<div class="math notranslate nohighlight">
\[\sum_k \dot{\omega}_k \equiv 0.\]</div>
<p>This second term arises from what was added to <a class="reference external" href="#eq:abar_X_k">[eq:abar_X_k]</a> by
Frank’s correction. Therefore, although important for individual derivatives
with respect to composition, this correction term has no effect on our
solution.</p>
</div>
<div class="section" id="convective-stability-criterion">
<h2>Convective stability criterion<a class="headerlink" href="#convective-stability-criterion" title="Permalink to this headline">¶</a></h2>
<p>Here we look at the criterion for convective stability in the case of
non-uniform chemical composition. This section follows Cox &amp; Giuli
<a href="#id1"><span class="problematic" id="id2">:raw-latex:`\cite{cg-ed2}`</span></a> closely (see chapter 13).</p>
<p>Consider a fluid parcel that gets displaced upwards (against gravity) from
a radial location <span class="math notranslate nohighlight">\(r\)</span> to <span class="math notranslate nohighlight">\(r + \Delta r\)</span>.
The parcel is stable to convection if the displaced parcel’s density is
greater than
the surrounding fluid and gravity pushes the parcel back towards where it came
from. Then the criterion for stability should be</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
 \rho_{parcel}(r+\Delta r) - \rho_{background}(r + \Delta r) &amp;&gt;&amp; 0 \\
 \bigg[\rho_{parcel}(r) + \bigg(\frac{d\rho}{dr}\bigg)_{parcel}\Delta r\bigg] -
 \bigg[\rho_{background}(r) + \bigg(\frac{d\rho}{dr}\bigg)_{background}\Delta r\bigg] &amp;&gt;&amp; 0 \end{aligned}\end{split}\]</div>
<p>Since the parcel originates at r, <span class="math notranslate nohighlight">\(\rho_{parcel}(r) = \rho_{background}(r)\)</span> and
so the stability criterion is</p>
<div class="math notranslate nohighlight">
\[\bigg(\frac{d\rho}{dr}\bigg)_{parcel} &gt; \bigg(\frac{d\rho}{dr}\bigg)_{background}
\label{eqn:basicStability}\]</div>
<p>Since the total pressure, <span class="math notranslate nohighlight">\(P\)</span>, always increases inward in a star in hydrostatic
equilibrium, we can use <span class="math notranslate nohighlight">\(P\)</span> instead of <span class="math notranslate nohighlight">\(r\)</span> as the independent radial variable.
Then condition for stability can be written as</p>
<div class="math notranslate nohighlight">
\[\bigg( \frac{d \ln \rho}{d \ln P}\bigg )_{parcel} &lt; \bigg(\frac{d \ln \rho}{d \ln P}\bigg)_{background}\]</div>
<p>Using the equation of state <span class="math notranslate nohighlight">\(P = P( \rho, T, \bar{\mu})\)</span>, where
<span class="math notranslate nohighlight">\(\bar{\mu}\)</span> is the average mass per molecule, we can write</p>
<div class="math notranslate nohighlight">
\[d \ln P = \frac{\partial \ln P}{\partial \ln \rho} \bigg |_{T, \bar{\mu}}d \ln \rho + \frac{\partial \ln P}{\partial \ln T} \bigg |_{\rho, \bar{\mu}} d \ln T + \frac{\partial \ln P}{\partial \ln \bar{\mu}}\bigg |_{\rho, T} d \ln \bar{\mu}\
\label{eqn:lnEOS}\]</div>
<p>For convenience we introduce</p>
<div class="math notranslate nohighlight">
\[\chi_{\rho} = \frac{\partial \ln P}{\partial \ln \rho}\bigg |_{T,\bar{\mu}} \qquad
  \chi_T = \frac{\partial \ln P}{\partial \ln T} \bigg |_{\rho,\bar{\mu}} \qquad
  \chi_{\bar{\mu}} = \frac{\partial \ln P}{\partial \ln \bar{\mu}} \bigg |_{\rho, T}\]</div>
<p>Then we can rearrange <a class="reference external" href="#eqn:lnEOS">[eqn:lnEOS]</a> to get</p>
<div class="math notranslate nohighlight">
\[\frac{d \ln \rho}{\partial \ln P} = \frac{1}{\chi_\rho} -
  \frac{\chi_T}{\chi_\rho} \frac{d \ln T}{d \ln P}- \frac{\chi_{\bar{\mu}}}{\chi_\rho}
  \frac{d \ln \bar{\mu}}{d \ln P}\]</div>
<p>Then the general stability criterion is</p>
<div class="math notranslate nohighlight">
\[\bigg ( \frac{1}{\chi_\rho} -
  \frac{\chi_T}{\chi_\rho} \frac{d \ln T}{d \ln P}- \frac{\chi_{\bar{\mu}}}{\chi_\rho}
  \frac{d \ln \bar{\mu}}{d \ln P} \bigg )_{parcel} &lt;
  \bigg ( \frac{1}{\chi_\rho} -
  \frac{\chi_T}{\chi_\rho} \frac{d \ln T}{d \ln P}- \frac{\chi_{\bar{\mu}}}{\chi_\rho}
  \frac{d \ln \bar{\mu}}{d \ln P} \bigg )_{background}
\label{eqn:genStability}\]</div>
<p>Here’s where various assumptions/simplifications get used.</p>
<ol class="arabic">
<li><p class="first">If no assumptions are made, you can’t get any further than equation
(<a class="reference external" href="#eqn:genStability">[eqn:genStability]</a>). Even in view of an infinitesimally small initial
perturbation, you can’t, in general, assume the <span class="math notranslate nohighlight">\(\chi\)</span>’s in parcel are the same
as the <span class="math notranslate nohighlight">\(\chi\)</span>’s in the background.
This applies in the case where nuclear reactions and/or ionization change the
composition of the parcel. This case tends not to be of much interest for
two reasons. Either composition effects get incorporated implicitly through
assuming chemical equilibrium. Or both of these terms can be neglected in the
rising parcel. This would be justified if the timescale for reactions
is long compared
to the convective timescale, and either the same is ture for ionization or the
fluid is fully ionized.</p>
</li>
<li><p class="first">If we assume that <span class="math notranslate nohighlight">\(\bar{\mu}\)</span> remains constant in the parcel, then
<span class="math notranslate nohighlight">\(\frac{d \ln \bar{\mu}}{d \ln P}\)</span> drops out for the parcel. In this case,
we can assume, in view of the arbitrarily small initial perturbation of
the parcel, that <span class="math notranslate nohighlight">\(\chi_\rho\)</span> and <span class="math notranslate nohighlight">\(\chi_T\)</span> to have the same values in the
parcel as in the background. Then the stability criterion becomes</p>
<div class="math notranslate nohighlight">
\[\bigg (  \frac{d \ln T}{d \ln P} \bigg )_{parcel} &gt;
  \bigg (  \frac{d \ln T}{d \ln P} + \frac{\chi_{\bar{\mu}}}{\chi_T}
  \frac{d \ln \bar{\mu}}{d \ln P} \bigg )_{background}
\label{eqn:Ledoux}\]</div>
<p>The Ledoux stability criterion is obtained by assuming that the parcel moves
adiabatically.</p>
</li>
<li><p class="first">If we assume
that the background is in chemical equilibrium and the parcel acheives
instantaneous chemical equilibrium, then <span class="math notranslate nohighlight">\(\bar{\mu} = \bar{\mu}(\rho,T)\)</span> for
the background and the parcel. (Note that we aren’t requiring constant
composition in the parcel here.)
The effect of variable composition are then absorbed into <span class="math notranslate nohighlight">\(\chi_\rho\)</span> and
<span class="math notranslate nohighlight">\(\chi_T\)</span>. Again, we can take <span class="math notranslate nohighlight">\(\chi_\rho\)</span> and <span class="math notranslate nohighlight">\(\chi_T\)</span> to have the same values
in the parcel as in the background. The criterion then is</p>
<div class="math notranslate nohighlight">
\[\bigg ( \frac{d \ln T}{d \ln P} \bigg )_{parcel} &gt;
  \bigg ( \frac{d \ln T}{d \ln P} \bigg )_{background}
\label{eqn:Schwarz}\]</div>
<p>We obtain the Schwarzchild criterion for
stability if we also assume the parcel moves adiabatically.</p>
<p>The Scharwzchild criterion can be recast in terms of entropy if
the EOS is taken as <span class="math notranslate nohighlight">\(P(\rho, S)\)</span> instead of <span class="math notranslate nohighlight">\(P(\rho, T)\)</span>. Then, in place
of equation (<a class="reference external" href="#eqn:lnEOS">[eqn:lnEOS]</a>) we have</p>
<div class="math notranslate nohighlight">
\[d \rho = \frac{\partial \rho}{\partial P} \bigg |_{S} d P + \frac{\partial \rho}{\partial S} \bigg |_{P} dS\]</div>
<p>We can subsitute this into equation (<a class="reference external" href="#eqn:basicStability">[eqn:basicStability]</a>) for stability,
and assuming the parcel moves adiabatically, we get</p>
<div class="math notranslate nohighlight">
\[\bigg ( \frac{\partial \rho}{\partial S} \bigg |_{P} \frac{dS}{dr}
  \bigg )_{background}&lt; 0\]</div>
<p>One of Maxwell’s relations is</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho^{-1}}{\partial S} \bigg |_{P} = \frac{\partial T}{\partial P} \bigg |_{S}\]</div>
<p>All thermodynamically stable substances have temperatures that increase upon
adiabatic compression, i.e. <span class="math notranslate nohighlight">\(\frac{\partial T}{\partial P} \big |_{S} &gt; 0\)</span>.
So Maxwell’s relation implies that
<span class="math notranslate nohighlight">\(\frac{\partial \rho}{\partial S} \big |_{P} &lt; 0\)</span>.
The stability criterion then becomes</p>
<div class="math notranslate nohighlight">
\[\bigg ( \frac{d S}{d r} \bigg )_{background} &gt; 0
\label{eqn:stabilityEntr}\]</div>
</li>
</ol>
<p>Determining which stability criterion we want to enforce in creating the
initial model is complicated by the phenomenon of semiconvection, which
occurs when the Ledoux criterion is statisfied but the Schwarzchild is not,
i.e.</p>
<div class="math notranslate nohighlight">
\[\bigg (  \frac{d \ln T}{d \ln P} \bigg )_{parcel} &lt;
  \bigg (  \frac{d \ln T}{d \ln P} \bigg )_{background} &lt;
  \bigg (  \frac{d \ln T}{d \ln P} \bigg )_{parcel} -
  \bigg ( \frac{\chi_{\bar{\mu}}}{\chi_T}
  \frac{d \ln \bar{\mu}}{d \ln P} \bigg )_{background}\]</div>
<p>(Note that <span class="math notranslate nohighlight">\(\chi_{\bar{\mu}}\)</span> is negative, as pressure is inversely proportional
to mass per particle, and <span class="math notranslate nohighlight">\(\frac{d \ln \bar{\mu}}{d \ln P}\)</span> is positive, since
nuclear reactions sythesize more massive particles in the center of the star.)
In this case, when a rising parcel eventually reaches neutral buoyancy, it will
have a temperature excess in comparision to it’s surroundings.
If the parcel can retain
it’s identitiy against diffusive mixing with the background long enough for
significant heat exhange to occur, then the parcel’s temperature will drop, it
will contract increasing it’s density, and the parcel will move inwards.
The time scale of semiconvection is much longer than the timescale of
traditional convection.</p>
<p>When we set up an initial model, we want to minimize any initial tendancy
towards convective motions, as we want these to be driven by the heating due
to nuclear reactions,
not the initial configuration we supply. Thus I think we want to guard against
semiconvection as well as “traditional” convection by using the stability
criterion</p>
<div class="math notranslate nohighlight">
\[\bigg ( \frac{d \ln T}{d \ln P} \bigg )_{parcel} =
\frac{d \ln T}{d \ln P} \bigg |_{S,\bar{\mu}} &gt;
  \bigg ( \frac{d \ln T}{d \ln P} \bigg )_{background}\]</div>
<p>Although this looks like the Schwarschild criterion (and, because I’m not
entirely sure on vocabulary, it might even be called the Schwarzchild
criterion), this does not simplify to equation (<a class="reference external" href="#eqn:stabilityEntr">[eqn:stabilityEntr]</a>)
because we need to keep the explicit <span class="math notranslate nohighlight">\(\bar{\mu}\)</span> dependence in the EOS.</p>
<p>The question of whether we’re in chemical equilibrium or not might be a moot
point since our EOS (or any other part of the code) doesn’t enforce chemical
equilibrium. Thus, even
in the case of chemical equilbrium, we can’t in general
drop the explicit <span class="math notranslate nohighlight">\(\bar{\mu}\)</span>
dependence from our equations. If we wanted to do that, then we would need
<span class="math notranslate nohighlight">\(\bar{\mu}(\rho,T)\)</span> to be substituted for <span class="math notranslate nohighlight">\(\bar{\mu}\)</span> inside the EOS.</p>
</div>
<div class="section" id="adiabatic-excess">
<span id="sec-adiabatic-excess"></span><h2>Adiabatic Excess<a class="headerlink" href="#adiabatic-excess" title="Permalink to this headline">¶</a></h2>
<p>The adiabatic excess, <span class="math notranslate nohighlight">\(\Delta\nabla\)</span>, is a quantity used to determine
if a system is stable (<span class="math notranslate nohighlight">\(\Delta\nabla &lt; 0\)</span>) or unstable (<span class="math notranslate nohighlight">\(\Delta\nabla
&gt; 0\)</span>) to convection under the Schwarzschild criterion (i.e. neglecting
compositional gradients). Cox and Giuli (see chapter 9) define three
different “adiabatic exponents” that we will use:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \Gamma_1 &amp;\equiv&amp;   \left(\frac{d\ln p}{d\ln\rho}\right)_\text{ad} \\
  \frac{\Gamma_2}{\Gamma_2-1} &amp;\equiv&amp;
  \left(\frac{d\ln p}{d\ln T}\right)_\text{ad} \\
  \Gamma_3 - 1 &amp;\equiv&amp; \left(\frac{d\ln T}{d\ln\rho}\right)_\text{ad},\end{aligned}\end{split}\]</div>
<p>where the subscript “ad” means along an adiabat. We can combine the
exponents to get the following relation</p>
<div class="math notranslate nohighlight">
\[\label{eq:Gamma relations}
  \Gamma_1 = \left(\frac{\Gamma_2}{\Gamma_2-1}\right)\left(\Gamma_3-1\right).\]</div>
<p>The adiabatic excess is defined as</p>
<div class="math notranslate nohighlight">
\[\label{eq:adiabatic excess}
  \Delta\nabla = \nabla_\text{actual} - \nabla_\text{ad}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\label{eq:thermal gradient}
  \nabla \equiv \frac{d\ln T}{d\ln P}\]</div>
<p>is the thermal gradient. It is important to note that these thermal
gradients are only along the radial direction. The “actual”
gradient can be found from finite differencing the data whereas the
adiabatic term, <span class="math notranslate nohighlight">\(\nabla_\text{ad} = \left(\Gamma_2-1\right) /
\Gamma_2\)</span>, will need to be calculated at each point using
thermodynamic relations. Our EOS only returns <span class="math notranslate nohighlight">\(\Gamma_1\)</span> so we need
find another relation to use with <a class="reference external" href="#eq:Gammarelations">[eq:Gamma relations]</a> to solve
for the adiabatic excess.</p>
<p>The Schwarzschild criterion does not care about changes in composition
and we therefore write <span class="math notranslate nohighlight">\(p = p(\rho,T)\)</span> and</p>
<div class="math notranslate nohighlight">
\[\label{eq:dp}
  d\ln p = \chi_\rho d\ln\rho + \chi_T d\ln T\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\chi_\rho = \left(\frac{d\ln p}{d\ln\rho}\right)_T,\qquad
\chi_T = \left(\frac{d\ln p}{d\ln T}\right)_\rho.\]</div>
<p>Dividing <a class="reference external" href="#eq:dp">[eq:dp]</a> by <span class="math notranslate nohighlight">\(d\ln\rho\)</span> and taking this along an adiabat
we have</p>
<div class="math notranslate nohighlight">
\[\label{eq:dp2}
  \left(\frac{d\ln p}{d\ln\rho}\right)_\text{ad} = \chi_\rho + \chi_T
  \left(\frac{d\ln T}{d\ln\rho}\right)_\text{ad}.\]</div>
<p>Using the <span class="math notranslate nohighlight">\(\Gamma\)</span>’s, we have</p>
<div class="math notranslate nohighlight">
\[\label{eq:Gamma1 relation with Gamma2}
  \Gamma_1 = \chi_\rho + \chi_T\left(\Gamma_3-1\right).\]</div>
<dl class="docutils">
<dt>Combining <a class="reference external" href="#eq:Gammarelations">[eq:Gamma relations]</a> and <a href="#id3"><span class="problematic" id="id4">`</span></a>[eq:Gamma1 relation</dt>
<dd>with Gamma2] &lt;#eq:Gamma1 relation
with Gamma2&gt;`__ to eliminate <span class="math notranslate nohighlight">\(\Gamma_3\)</span>, we have:</dd>
</dl>
<div class="math notranslate nohighlight">
\[\label{eq:nabla_ad}
  \nabla_\text{ad} = \frac{\Gamma_1 - \chi_\rho}{\chi_T\Gamma_1}\]</div>
<p>which uses only terms which are easily returned from an EOS call.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="beta0.html" class="btn btn-neutral float-right" title="Notes on \(\beta_0\)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="planar_invsq_basestate.html" class="btn btn-neutral float-left" title="Modifications for a \(1/r^2\) Plane-Parallel Basestate" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, MAESTROeX development tem

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>